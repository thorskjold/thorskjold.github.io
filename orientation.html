<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>

        body {
            font-family: -apple-system, Helvetica;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #start {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        #orientation, #switch {
            display: none;
        }
        #alpha, #beta, #gamma {
            display: none;
            width: 90%;
            height: 10vh;
        }

        /* The switch - the box around the slider */
        .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
        }

        /* Hide default HTML checkbox */
        .switch input {
        opacity: 0;
        width: 0;
        height: 0;
        }

        /* The slider */
        .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
        }

        .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        -webkit-transition: .4s;
        transition: .4s;
        }

        input:checked + .slider {
        background-color: #16c946;
        }

        input:focus + .slider {
        box-shadow: 0 0 1px #16c946;
        }

        input:checked + .slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
        border-radius: 34px;
        }

        .slider.round:before {
        border-radius: 50%;
        }

    </style>
</head>

<body>

    <div id="start" onclick="request()">Start measuring</div>
    <img draggable="false" id="orientation" src="orientation.png">
    <label id="switch" class="switch"><input type="checkbox" id="rounded" onclick="precision()"><span class="slider round"></span></label>
    <div id="alpha">Alpha [0, 360]: 0</div>
    <div id="beta">Beta [-180, 180]: 0</div>
    <div id="gamma">Gamma [-180, 180]: 0</div>

</body>

<script>

    function precision() {

        if (document.getElementById("rounded").checked) {
            window.round = true;
        } else {
            window.round = false;
        };
        
    };

    function assign() {

        document.getElementById("start").style.display = "none";
        document.getElementById("orientation").style.display = "block";
        document.getElementById("switch").style.display = "block";
        document.getElementById("alpha").style.display = "block";
        document.getElementById("beta").style.display = "block";
        document.getElementById("gamma").style.display = "block";

        window.addEventListener("deviceorientation", function(event) {
            if (window.round) {
                document.getElementById("alpha").innerHTML = "Alpha [0, 360]: " + parseInt(event.alpha);
                document.getElementById("beta").innerHTML = "Beta [-180, 180]: " + parseInt(event.beta);
                document.getElementById("gamma").innerHTML = "Gamma [-180, 180]: " + parseInt(event.gamma);
            } else {
                document.getElementById("alpha").innerHTML = "Alpha [0, 360]: " + event.alpha;
                document.getElementById("beta").innerHTML = "Beta [-180, 180]: " + event.beta;
                document.getElementById("gamma").innerHTML = "Gamma [-180, 180]: " + event.gamma;
            };
        });

        console.log("Listening for orientation.")

    };

    function request() {

        assign();

        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            assign();
                        };
                    })
                    .catch(console.error);
            };
        };

    };

</script>

</html>